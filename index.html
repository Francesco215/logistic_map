<!doctype html>
<meta charset="utf-8">
<script src="template-1.1.1/dist/template.js"></script>
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
<script type="text/front-matter">
  title: "The logistic map"
  description: "inserire sottotitolo"
  authors:
  - Francesco Sacco: https://github.com/Francesco215
  affiliations:
  - University of Pisa: http://unipi.it
</script>



<dt-banner style="display: none;"></dt-banner>
<dt-article id="article">
  <script src="library.js"></script>

  <h1> The Logistic Map</h1>
  <h2>Here we explore the weird properties of the logistic map</h2>
  <dt-byline></dt-byline>
  <p>
    The best way to introduce yourself to the logistic map is to watch this video <dt-cite key="veritasium"></dt-cite>,
    if you are intrested in the subject theese are probably the best 18 minutes you will ever spend on Youtube.
    Most of the tecnical stuff of this page is taken from <dt-cite key="strogatz"></dt-cite>
  </p>
  <h2><a class="marker" href="#section-1" id="section-1">1</a> The Definition</h2>
  <p>
    The definition of the logistic map is as simple as it gets, yet il leads to very complex and intresting behavior  <dt-cite key="logistic"></dt-cite>.
    \[x_{n+1} = rx_n(1-x_n)\] 
    where \(0\le r \le 4 \) is a parameter
      <dt-fn>
        This is because the maximum of the logistic function is \(r/4\),
        and if we want to keep \(x_{n}\in [0,1]\) we must keep \(r \in [0,4]\) 
      </dt-fn>

  </p>
  <div style="position: relative; height:500px; left:-50px;">
    <svg id="curve0" style="width:700px; height:400px;"></svg>
    <div style="position:absolute; width:300px; height: 50px; left:670px; top: 390px;">\(x_n\)</div> <!--xlabel-->
    <div style="position:absolute; width:300px; height: 50px; left:70px; top: 10px;">\(x_{n+1}\)</div> <!--xlabel-->
    <div style="position:absolute; width:300px; height: 50px; left:100px; top: 430px;">
      <input type="range" min="0" max="4" step="0.05" value="3.4" id="r0">
      <div id="displayR0" ><eqdin>\(r=3.4\) </eqdin></div>
    </div>
    <script src="logistic0.js"></script> 
  </div>    

  <p>
    It was first theorized as a way to model population growth in a system with finite resouces.
    We can imagine \(x_n\) as a precentage of the theoretical maximum of animals, so
    the term \(rx_n\) represents the growth rate if the resouces are infinite, and the term \((1-x_n\))
    makes the population shrink as it approaches 1.
  </p>

    <h2><a class="marker" href="#section-2" id="section-2">2</a> Dynamics</h2>
    <p>
      Now let's plot a succession \(x_n\) with a starting point \(x_0\) and examine what happens
      as we change \(r\) and \(x_0\)
    </p>
    <div style="position: relative; height:500px; left:-50px;">
      <div style="position: relative; height:400px" id="zigzag"></div>
      <div style="position:absolute; width:300px; height: 50px; left:670px; top: 390px;">\(n\)</div> <!--xlabel-->
      <div style="position:absolute; width:300px; height: 50px; left:70px; top: 10px;">\(x\)</div> <!--xlabel-->
      <div style="position:absolute; width:300px; height: 50px; left:100px; top: 430px;">
        <input type="range" min="0" max="4" step="0.05" value="3.4" id="r1">
        <div id="displayR1" ><eqdin>\(r=3.4\) </eqdin></div>
      </div>
      <script src='zigzag.js'></script>
    </div>
    <p>
      Just from playing with the graph can be understood that \(x_0\) has very little effect on the long-term
      behavior of the system, meanwhile changing \(r\) can make the succession evolve in very different ways.
      In particular:
      <ul>
        <li>For \(r\le 1\quad x_n\to 0\). This can be explained by the fact that \(r< 1\) represents
        a declining population in model where \(x_{n+1}=rx_n\), and the factor \(1-x_n\) is always less than \(1\)</li>
        <li>For \(1&lt r &lt r_1 \), where \(r_1\) is some constant we don't know anything about yet, 
          the map converges to a single value</li>
        <li>
          For \(r_1&lt r &lt r_2 \) the tends to oscillate between 2 values
        </li>
        <li>
          For \(r_2&lt r &lt r_3 \) the tends to oscillate between 4 values
        </li>
        <li>
          For \(r_3&lt r &lt r_4 \) the tends to oscillate between 8 values
        </li>
        <li>
          After that it becomes harder and harder to see if the periods keep doubling because the constants \(r_n\)
          keep getting closer together, so it seems that they converge to some constant \(r_\infty\)
        </li>
        <li>
          After that, the way the system behaves is chaotic, with a "island" of stability 3
        </li>
      </ul>
      </p>
  <h2><a class="marker" href="#section-3" id="section-3">3</a> The Bifurcation Diagram</h2>
    <div class="l-page side">
      <a class="marker" href="#image-1" id="image-1">
        <img src="https://upload.wikimedia.org/wikipedia/commons/7/7d/LogisticMap_BifurcationDiagram.png" style='height: 100%; width: 100%; object-fit: contain'>
      </a>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 704px" >
        Figure 1: Bifurcation diagram [<a href="https://commons.wikimedia.org/wiki/File:Logistic_Bifurcation_map_High_Resolution.png">source</a>]

      </figcaption>
    </div>
    <p>
      The bifurcation diagram summarizes this (figure <a href="#image-1">1</a>). The horizontal axis shows all possible values of \(r\) and
      the vertical axis shows the set of values of \(x\) visited asymptotically from almost all initial
      conditions by the iterates of the logistic equation with that \(r\) value. 
    </p>
    <p>
      The bifurcation diagram is a self-similar: if we zoom in on the above-mentioned value \(r_\infty\)
      and focus on one arm of the three, the situation nearby looks like a shrunk and slightly distorted
      version of the whole diagram. The same is true for all other non-chaotic points.
      This is an example of the deep and ubiquitous connection between chaos and fractals. (figure <a href="#image-2">2</a>)
    </p>
    <div class="l-page-outset">
      <a class="marker" href="#image-2" id="image-2">
        <img src="https://upload.wikimedia.org/wikipedia/commons/9/9c/Logistic_map_bifurcation_diagram_magnifications.png" style='height: 100%; width: 100%; object-fit: contain'>
      </a>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 704px" >
        Figure 2: Bifurcation diagram zoomed [<a href="https://commons.wikimedia.org/wiki/File:Logistic_map_bifurcation_diagram_magnifications.png">source</a>]

      </figcaption>
    </div>
    <div class="l-page side">
      <a class="marker" href="#image-3" id="image-3">
        <img src="https://upload.wikimedia.org/wikipedia/commons/2/27/Logistic_Map_Bifurcations_Underneath_Mandelbrot_Set.gif" style='height: 100%; width: 100%; object-fit: contain'>
      </a>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 704px" >
        Figure 3: Bifurcation diagram of the Mandelbrot Set [<a href="https://commons.wikimedia.org/wiki/File:Logistic_Map_Bifurcations_Underneath_Mandelbrot_Set.gif">source</a>]

      </figcaption>
    </div>  
    <div class="l-page side">
      <a class="marker" href="#image-4" id="image-4">
        <img src="images/feigconstants.png" style='height: 100%; width: 100%; object-fit: contain'>
      </a>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 704px" >
        Figure 4: Visual representation of \(d_n\) and \(\Delta_n\) <dt-cite key="strogatz"></dt-cite>

      </figcaption>
    </div>  
    <p>
      The most incredible property of the bifurcation diagram is that the ratio the difference between successive \(r_n\)
      converges to a constant \(\delta\) called "Feigenbaum's Constant"  <dt-cite key="feigenbaum"></dt-cite>, so let
      \(\Delta_n=r_n-r_{n-1}\)
      \[
        \delta=\lim_{n\to\infty}\frac{\Delta_n}{\Delta_{n+1}}= 4.699\dots
      \]
      Not only that! if we change the function of the mapping \(x_{n+1}=f(x_n)\) the resulting bifurcation diagram
      has the same constant<dt-fn>With a few exceptions</dt-fn>, even the Mandelbrot set!
      <dt-fn>For the Mandelbrot set \(f(x)=x^2+r\)</dt-fn> (figure <a href="#image-3">3</a>)
    </p>
    <p>
      The same goes for another constant that emerges in the bifurcation diagram of unidimentional maps. Let
      \(f(x_{n+1})=f(x_n)\) be a generic map with maximum in \(x_m\), then let \(R_n\) be the intersection 
      between the bifurcation diagram and \(x=x_m\), and let \(d_n\) be the width of the pitchfork at \(R_n\), then
      \[
        \alpha=\lim_{n\to\infty}\frac{d_n}{d_{n+1}}=2.5029\dots
      \]
      We will talk in more detail about this two constants in the section about Renomalization
    </p>
    <p>
      Unfortunately, just by watching the bifurcation diagram this is all we can tell, in order to have
      a deeper understanding of the phenomenon we must use another visual method.
    </p>







  <h2><a class="marker" href="#section-4" id="section-4">4</a> The Cobweb</h2>
    <p>
      Given \(x_{n+1}=f(x_n)\) the Cobweb works as follows: 
      <ul>
        <li>
          Start with an initial condition \(x_0\) draw a vertical line until it intersect the graph \(f\),
          that height is by definition \(x_1\)
        </li>
        <li>
          Draw a horizontal line until it intersects the bisectrix \(x_{n+1}=x_n\)
        </li>
        <li>
          Ok, now move again vertically towards the curve of \(f\), since the \(x\) component is equal to \(x_1\),
          the line now intersects the line at \(y=x_2\)
        </li>
        <li>
          Keep going
        </li>
      </ul>

    </p>
    
    
    <div style="position: relative; height:800px; left:-50px;">
      
      <div style="position: relative; height:640px" id="cobweb"></div>      
      <div style="position:relative; width:300px; height: 50px; left:670px; top: -10px;">\(x_n\)</div> <!--xlabel-->
      <div style="position:absolute; width:300px; height: 50px; left:70px; top: 0px;">\(x_{n+1}\)</div> <!--xlabel-->
      
      <div style="position:relative; width:800px; height: 50px; left:75px; top: -10px;">      
        <div style="position:absolute; width:300px; height: 50px; left:0px;">
          <input type="range" min="0" max="4" step="0.01" value="3.4" id="r2">
          <div id="displayR2" ><eqdin>\(r=3.4\) </eqdin></div>
        </div>
        <div style="position:absolute; width:300px; height: 50px; left:200px;">
          <input type="range" min="-2" max="2" step="0.01" value="10" id="l_2">
          <div id="displayL_2"><eqdin>\(l = 10\)</eqdin></div>
        </div>
      </div>
      
      <script src='cobweb.js'></script>
    </div> 
    <p>
      By playing with the graph you can clearly see that for low \(r\) the equilibrium points are
      the ones in the intersection between \(f(x)\) and the bisectrix. This makes sense because if \(f(x^*)=x^*\)
      Where \(x^*\) is the intersection point the succession stays constant.
      But why for some \(r\) doesn't want to stay on \(x^*\)?.
    </p>
    <p>
      This is because it isn't a stable equilibrium point. Just like in physics, to see if a equilibrium point
      is stable or not you just have to put your system just slightly off \(x^*\) and see what it does, if in the next
      iteration it gets further from the equilibrium point that it's unstable, otherwise it's stable, written in mathematical
      tems...
      $$
        \left\{ 
          \begin{array}{c}
          \mathrm{if}\quad \Big|\frac{f(x^*+\epsilon)-x^*}{\epsilon}\Big|>1\quad \mathrm{is\: unstable}\\ 
          \mathrm{if}\quad \Big|\frac{f(x^*+\epsilon)-x^*}{\epsilon}\Big|&lt1\quad \mathrm{is\: stable}\\
          \mathrm{if}\quad \Big|\frac{f(x^*+\epsilon)-x^*}{\epsilon}\Big|=1\quad \mathrm{we\: don't\: know}
          \end{array}
        \right. 
      $$
      Since \(\epsilon\) is small we can expand \(f\) around \(x^*\)
      \[f(x^*+\epsilon)=f(x^*)+f'(x^*)\epsilon\]
      And if we substitute this in the system above
      <dt-fn>
        I have written that if \(|f'(x^*)|=1\;\;\) \(x^*\) is stable because for the logistic (and for most functions) it means that
        you are either passing throught the regime where \(x_n\to0\) to the one where \(x_n\to c\in (0,1]\),
        but \(\lim_{\epsilon\to 0}c=0\), so \(x^*=0\) is a stable point. Or you are right on the first bifurcation,
        so the function oscillates in between two points that get closer and closer toghether as \(\epsilon\to 0\).
        Let me reiterate that this does not hold for all functions, but we are going to pretend that it does for
        sake of simplicity.
      </dt-fn>
      $$
        \left\{ 
          \begin{array}{c}
          \mathrm{if}\quad |f'(x^*)|>1 \quad\mathrm{is\: unstable}\\ 
          \mathrm{if}\quad |f'(x^*)|\le1\quad \mathrm{is\: stable}
          \end{array}
        \right. 
      $$
      If \(|f'(x^*)|=0\) than the function is "Superstable" in \(x^*\), this means that it converges faster than
      exponential.<dt-fn>I have mentioned it because the superstable points will be useful later</dt-fn>
    </p>
    <p>
      For the logistic map \(f'(x)=r(1-2x)\) and the fixed point are found solving \(x^*=f(x^*)=rx^*(1-x^*)\),
      which has as solutions \(x^*=0\) and \(x^*=1-1/r\). The latter one of which is in the range of allowable
      \(x\) only if \(r\ge 1\)
    </p>
    <p>
      Let's study the stability by calculating the derivative
      $$
        \left\{ 
          \begin{array}{c}
          f'(x^*=0)=r\quad\rightarrow\quad \mathrm{stable\: for\: r\le1}\\
          f'(x^*=1-1/r)= 2-r \quad\rightarrow\quad \mathrm{stable\: for\:1\le r\le3}
          \end{array}
        \right. 
      $$
    </p>
    <p>
      Studying \(f'\) we can only calculate \(r_0\) and \(r_1\), if we want to know more about stable Cycles
      we need to study \(f^2(x)=f\big(f(x)\big)\), \(f^4(x)\), and so on...
    </p>
    <p>
      This is because if we end up in a stable 2-cycle it means that \(x_{n+2}=f^2(x_{n})=x_{n}\), the same idea
      goes for any \(c\)-cycle. You can see it visually by setting the cobweb for \(c=1\) and \(r\) slightly
      bigger than 3 so that you have a 2-cycle and than changing \(c=2\)
    </p>
    <div style="position: relative; height:800px; left:-50px;">
      
      <div style="position: relative; height:640px" id="cobwebN"></div>      
      <div style="position:relative; width:300px; height: 50px; left:670px; top: -10px;">\(x_n\)</div> <!--xlabel-->
      <div id="yax" style="position:absolute; width:300px; height: 50px; left:70px; top: 0px;">
        <eqdin>
          \(x_{n+1}\)
        </eqdin>
      </div> <!--ylabel-->
      
      <div style="position:relative; width:800px; height: 50px; left:75px; top: -10px;">      
        <div style="position:absolute; width:300px; height: 50px; left:0px;">
          <input type="range" min="0" max="4" step="0.01" value="3.4" id="r3">
          <div id="displayR3" ><eqdin>\(r=3.4\) </eqdin></div>
        </div>
        <div style="position:absolute; width:300px; height: 50px; left:200px;">
          <input type="range" min="-2" max="2" step="0.01" value="10" id="l_3">
          <div id="displayL_3"><eqdin>\(l = 10\)</eqdin></div>
        </div>
        <div style="position:absolute; width:300px; height: 50px; left:400px;">
          <input type="range" min="1" max="10" step="1" value="2" id="n_3">
          <div id="displayN_3"><eqdin>\(c = 2\)</eqdin></div>
        </div>
      </div>
      
      <script src='cobwebN.js'></script>
    </div> 

    <p>
      As you can see the cobweb converges to one of the 2 values the function oscillates with. The same goes if you
      put the system in a generic \(c\)-cycle.
    </p>
    <p>
      Just like we did before we can study the stability of the 2-cycle by studying \(f^2(x)\) and 
      \(\big(f^2\big)'(x)\). The resultin formula is a quartic polynomial, but since \(x^*=0,1-1/r\) are still
      solutions, it can be factorized in this way:
      \[
        f^2(x)=r^2x(1-x)\big[1-rx(1-x)\big]
      \]
      The temn in the square parenthesis gives us this two solutions
      \[
        x_{1,2}^*=\frac{r+1\pm\sqrt{(r-3)(r+1)}}{2r}
      \]
      since we want them to be physical solutions we want \((r-3)(r+1)\ge0\), thus a 2-cycle
      exists for \(r>3\)
    </p>
    <p>
      To study the stability we calculate the derivative in one of the two points
      \[<!--Ma merchè sto apostrofo è enorme!?-->
        \big(f^2(x_1^*)\big)' =f'(x_1^*)f'(x_2^*)=r^2(1-2x_1^*)(1-2x_2^*)=
      \]
      \[
        =r^2\big[1-2(x_1^*+x_2^*)+4x_1^*+x_2^*\big]=r^2\big[1-2(r+1)/r+r(r+1)/r^2\big]=
      \]
      \[
        =4+2r-r^2
      \]
      Therefore the cycle is stable for \(|4+2r-r^2|\le 1\), i.e. for \[3\le r\le 1+\sqrt 6\]
      From now on a few more analytical results can be obtained, but they are much harder and
      they don't really give much insight, so we are going to skip them.
    </p>
  






  <h2><a class="marker" href="#section-4" id="section-4">4</a> Renomalization</h2>
    <p>
      So far we have explained how to calculate when the bifurcation occur, this can help us to estimate the
      Feigenbaum's constant, but there is a much more efficent and general way to calculate it and to explain
      why it comes up the same in every generating function \(f\), and it's by using renormalization theory.
    </p>
    <h3><a class="marker" href="#section-4.1" id="section-4.1">4.1</a> Finding \(\alpha\)</h3>

    <div class="l-page side">
      <a class="marker" href="#image-5" id="image-5">
        <img src="images/R_n.png" style='height: 100%; width: 100%; object-fit: contain'>
      </a>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 704px" >
        Figure 5: Schematic diagram that shows where are the \(R_n\) <dt-cite key="strogatz"></dt-cite>

      </figcaption>
    </div> 
    <p>
      First we introduce some notation. Let \(f(x,r)\) denote a unimodal map that undergoes a period doubling route to
      chaos as \(r\) increases, and suppose that \(x_m\) is the maximum on \(f\). Let \(r_n\) the value of \(r\) at which
      the \(2^n\)-cycle, and let \(R_n\) the value of \(r\) at which the \(2^n\)-cycle is superstable.
    </p>
    <p>
      A \(n\)-cycle to be superstable has to satisfy that 
      \[
        \big(f^{n}(x^*,R_n)\big)'=\prod_{i=1}^{n}f'(x_i^*,R_n)=0
      \]
      Therefore  \(x_m\in\{x_i^*\}\), consequently a simple way to locate \(R_n\) is to intersect the bifurcation
      diagram with \(x=x_m\). (figure <a href="#image4">4</a>)
    </p>
    <p>
      Now let's take a look at \(f(x,R_0)\) and \(f^2(x,R_1)\) (figure <a href="#image5">5</a>), as you can see the
      image (c) looks like a smaller rotated version of (a)
    </p>
    <div class="l-body">
      <a class="marker" href="#image-6" id="image-6">
        <img src="images/renormalization1.png" style='height: 100%; width: 100%; object-fit: contain'>
      </a>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 704px" >
        Figure 6: confront between \(f(x,R_0)\) and \(f^2(x,R_1)\) <dt-cite key="strogatz"></dt-cite>
      </figcaption>
    </div> 
    <p>
      Now we "Renormalize" the image in (c) such that it's as similar as possible to \(f(x,R_0)\), to do so we move
      the origin of \(x\) such that \(x_m=0\), than we blow it up by a factor \(|\alpha|&gt 1\) in both direction
      and invert both axis \((x,y)\to(-x,-y)\).
    </p>
    <p>
      We can do both operations at once by taking the scaling factor \(\alpha\) negative. Doing so is equivalent
      to replacing \(f^2(x,R_1)\) with \(\alpha f^2(x/\alpha,R_1)\). Now we can express mathematically that they
      are similar like so 
      \[
        f(x,R_0)\approx\alpha f(x/\alpha,R_1)
      \]
      You can see it represented in the figure below
    </p>
    <p>
      The reason this \(\alpha\) is one of the Feigenbaum's constans is that when we renormalize we elongate the \(x\)
      axis by \(\alpha\), so effectively, in the bifurcation diagram we widen the pitchforks by \(\alpha\).
    </p>
    <div class="l-body">
      <a class="marker" href="#image-7" id="image-7">
        <img src="images/renormalization2.png" style='height: 100%; width: 100%; object-fit: contain'>
      </a>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 704px" >
        Figure 7: Renormalization procedure between \(f(x,R_0)\) and \(f^2(x,R_1)\) <dt-cite key="strogatz"></dt-cite>
      </figcaption>
    </div> 
    <p>
      Renormalizing between \(f(x,R_0)\) and \(f^2(x,R_1)\) is approximate, but the good part is that the more
      you renormalize, the more precise it becomes. For example \(f^2(x,R_1)\approx\alpha f^4(x/\alpha,R_2)\) is
      a better approximation than the one between \(f\) and \(f^2\).
      It is possible to concatenate \(n\) of this rinormalizations like so 
      \[f(x,R_0)\approx \alpha^nf^{2^n}\bigg(\frac{x}{\alpha^n},R_n\bigg)\]
      And it is possible to renomalize infinitely
      \[\lim_{n\to\infty}\alpha^nf^{2^n}\bigg(\frac{x}{\alpha^n},R_n\bigg)=\nu g_0(x/\nu) \]
      In the end you get this function \(g_0(x)\) that is a <b>universal function</b>. Since it is obtained
      by zooming \(n\to\infty\) times by \(\alpha\) it has this two important properties:
      <ul>
        <li>
          It only exists if \(\alpha\) is chosen correctly (\(\alpha=-2.5029\dots\)), otherwise you would zoom too much or too little
        </li>
        <li>
          It is indipendent of the original shape of \(f\). This is because we keep zooming closer and closer
          into the maximum of the function, so the only thing that remains is the order of the maximum
          <dt-fn>Keep in mind that it doesn't depend on the coefficient, just the order. This is because the only 
            thing we want when renormalizing is that the renormalized function resembles the original. The 
            procedure we use assures us that the coefficient of the first non-zero order of the taylor expantion
            stays constant.
          </dt-fn>
        </li>
      </ul>
      <p>
      Since the memory of the first non-zero coefficent of the taylor expantion is engraved in \(\nu\), different
      generating functions \(f_i\) will have different \(\nu_i\), but without
      loss of generality we can set \(\nu=1\) for the logistic map.
      </p>
    </p>
    <p>
      Different universal function \(g_i(x)\) can be generated starting with \(f(x,R_i)\) instead of \(f(x,R_0)\)
      \[
        \nu g_i(x/\nu)=\lim_{n\to\infty}\alpha^nf^{2^n}\bigg(\frac{x}{\alpha^n},R_{n+i}\bigg)
      \]
      The case where we are on the onset of chaos \(R_i=R_\infty\) is the most important since then

      \[
        f(x,R_\infty)\approx\alpha f^2(x/\alpha, R_\infty)
      \]
      and we get the universal function \(g\equiv g_\infty\) that is self referential<dt-fn>I have already set \(\nu=1\)</dt-fn>
      \[
        g(x)=\alpha g^2(x/\alpha)
      \]
      This \(g\) is special because of this formula, it allows us throught some clever math to estimate \(\alpha\)
      whithout doing lots of calculations, we just have to taylor expand both terms and equate the coefficient of the
      same order.
      \[
        g(x)=c_0+c_1x+c_2x^2+c_2x^3+\dots
      \]
      We can change the definition of \(g\) by changing \(\nu\) we can we can set \(g(0)=c_0=1\) 
      at \(x=0\), and since the \(x_m=0\) \(g'(0)=c_1=0\), so
      \[
        g(x)=1+c_2x^2+c_3x^3+\dots
      \]
      By equating the coefficients up to the seventh order can be found \(c_2 \approx 1.5276\), \(c_4\approx 0.1048\)
      and \(\alpha\approx -2.5029\)
    </p>
    <p>
      If you want a more precise measurament of \(\alpha\) you can just consider higher and higher orders of the Taylor
      expantion, using this theory also explains the value \(\delta\), but it uses much more complicated mathematical 
      methods, so we are going to skip it, instead we are going to find an approximation of \(\delta\) but it isn't
      in the form of a series.
    </p>
    <h3><a class="marker" href="#section-4.2" id="section-4.2">4.2</a> Finding \(\delta\)</h3>
    <p>
      Let \(f(x,\mu)\) be a unimodal map that undergoes the period-doubling route to chaos. We are going to define
      the variables such that the 2-cycle is born when \(x=0\) and \(\mu=0\), and than we are going to taylor expand
      around \(x=0\).
      <dt-fn>
        The 0th order coefficient of the taylor expantion has to be zero because when \(\mu,x=0\)
        \(x_{n+1}\) must be \(0\). The first order coefficient of the taylor expantion must be equal to \(-(1+\mu)\)
        because when \(\mu=0\) we must have that \(|f'(x)=1|\).
      </dt-fn>
      We are going to neglet all higher order of \(x\) and \(\mu\), and that's why our results will be approximate.
      \[
        x_{n+1}=-(1+\mu)x_n + ax_n^2
      \]
      We can set \(a=1\) since it's equivalent to rescaling \(x\to x/a\), so in the end \[x_{n+1}=-(1+\mu)x_n + x_n^2\]
    </p>
    <p>
      What we are goint to try to do is the following:
      <ul>
        <li>
          For \(\mu>0\) there is a 2-cycle with fixed points \(x_{1,2}^*\) 
        </li>
        <li>
          If we keep increasing \(\mu\), \(x_{1,2}^*\) will eventually period double giving rise to a 4-cycle
        </li>
        <li>
          When this happens \(f^2\) will have the same algebraic structure near, say, \(x_1^*\) 
        </li>
        <li>
          Try to renormalize \(f^2(x_1^*)\) into \(f(0)\) and see what it comes up
        </li>
      </ul>
    </p>
    <p>
      So let's start by calculating \(f(x_{1,2}^*)\)
      $$
        \left\{ 
          \begin{array}{c}
          x_1^*=-(1+\mu)x_2^* + \big(x_2^*\big)^2\\ 
          x_2^*=-(1+\mu)x_1^* + \big(x_1^*\big)^2
          \end{array}
        \right. 
      $$
      Solving the system we have that
      \[
        x_{1,2}^*=\frac{\mu\pm\sqrt{\mu^2+4\mu}}2
      \]
      Now we can take the first step for the renormalization: Traslating the origin, we are going to set in
      \(x^*=x_1^*\)
      <dt-fn>
        We could have chosen \(x_2^*\) it doesn't matter
      </dt-fn>
      and let's see how \(x^*+\eta_{n+1}=f^2(x^*+\eta_n)\) behaves by expanding it up to the second order, and we get
      \[
        \eta_{n+1}= (1-4\mu-\mu^2)\eta_n + C\eta_n^2 + \dots
        \qquad C= 4\mu +\mu^2 -3\sqrt{\mu^2+4\mu}
      \]
      To rescale \(\eta\) let \(\tilde x_n=C\eta_n\), and let \(\tilde\mu=4\mu-\mu^2-2\) then the equation above becomes
      \[
       \tilde x_{n+1}=-(1-\tilde\mu)\tilde x_n+ \tilde x_n^2+\dots
      \]
      This equation is very similar to the original, so
      \[
        f(x,\mu)\approx f^2(\tilde x, \tilde\mu)=f^2(x^*+ x/C,4\mu+\mu^2-2)
      \]
      remeber that \(x^*=\frac{\mu+\sqrt{\mu^2+4\mu}}2\) and \(C= 4\mu +\mu^2 -3\sqrt{\mu^2+4\mu}\)
    </p>
    <p>
      Because of the fact that the system has the same structure when \(\tilde\mu=\mu\) the system undergoes a bifurcation. It is possible to estimate it in terms of \(\mu\)
      by solving \(4\mu_2+\mu_2^2-2=\mu=0\) we get the solution \(\mu_2=-2+\sqrt 6\)
      <dt-fn>
        I called it \(\mu_2\) because this represents the moment where the bifurcation happends for the second time,
        from now on i will use this notation, consequently, \(\mu_1=\mu\) and \(\tilde\mu_1=\tilde\mu\)
      </dt-fn>

    </p>
    <p>
      As before it is possible to renormalize further by linking
      \[
        f^{2^n}(x,\mu_n)\approx f^{2^{n+1}}(\tilde x,\tilde\mu_n)
      \]
      and now the way you find \(\mu_{n+1}\) is by setting \(\tilde\mu_n=\mu_n\)
      \[
        \mu_n=4\mu_{n+1}+\mu_{n+1}^2 -2 
      \]so
      \[\mu_{n+1}=-2\sqrt{6+\mu_{n}}\]
      And at the onset of chaos we have that
      \[
        \mu_\infty=4\mu_\infty+\mu_\infty^2-2\quad \rightarrow\quad \mu_\infty=\big(\sqrt{17}-3\big)/2\approx 0.56
      \]
      For the logistic map this give us a pretty good estimation of \(r_\infty\), all we have to do is
      add 3 to the result. With out method \(r_\infty\approx 3.56\), while the exact result is \(r_\infty= 3.57\dots\)
    </p>
    <p>
      Now the thing we all have been waiting for: The estimation of \(\delta\)
    </p>
    <p>
      For \(n\gg 1\) \(\mu_n\) should converge geometrically to \(\mu_\infty\), so we have that
      \[
        \delta=\lim_{n\to\infty}\frac{\mu_{n}-\mu_\infty}{\mu_{n+1}-\mu_\infty}
      \] 
      Since this tends to \(0/0\) we can use de l'Hopital's rule
      \[
        \delta=\frac{d\mu_{n}}{d\mu_{n+1}}\bigg|_{\mu_{n+1}=\mu_\infty}=2\mu_\infty+4\approx 5.12
      \]
      It's off by 10% the true value of \(\delta=4.67\dots\)
    </p>





  <h2><a class="marker" href="#section-5" id="section-5">5</a> The Logistic map for differential equations</h2>

  <p>
      Most real life systems are way more complex than 1-D maps and most of the times evolve following differential
      equations, yet The bifurcation diagrams shows up in many situations. To see why let's look at The Rossler system
      witch is a set of three differential equations:
      $$
        \left\{ 
          \begin{array}{c}
          \dot x = y-z\\
          \dot y= x+ay\\
          \dot z= b+z(x-c)
          \end{array}
        \right. 
      $$
      This system contains only one non linear term, for this example we are going to set \(a=b=0.2\) and change \(c\)
      <dt-fn>The system in order to be chaotic needs to be in 3 dimentions otherwise it can't cross itself</dt-fn>
    </p>
    <div style="position: relative; height:800px; left:-50px;">
      
      <div style="position: relative; height:640px" id="rossler"></div>      
      <div style="position:relative; width:300px; height: 50px; left:670px; top: -10px;">\(x\)</div> <!--xlabel-->
      <div style="position:absolute; width:300px; height: 50px; left:70px; top: 0px;">\(y\)</div> <!--xlabel-->
      
      <div style="position:relative; width:800px; height: 50px; left:75px; top: -10px;">      
        <div style="position:absolute; width:300px; height: 50px; left:0px;">
          <input type="range" min="1.2" max="10" step="0.01" value="3.4" id="c">
          <div id="displayC" ><eqdin>\(c=3.4\) </eqdin></div>
        </div>
      </div>
      <script src='rossler.js'></script> 
    </div>

    <div style="position: relative; height:500px; left:-50px;">

      <div style="position: relative; height:400px" id="rossler1D"></div>      
      <div style="position:relative; width:300px; height: 50px; left:670px; top: -10px;">\(t\)</div> <!--xlabel-->
      <div style="position:absolute; width:300px; height: 50px; left:70px; top: 0px;">\(x(t)\)</div> <!--xlabel-->
      <script src='rossler1D.js'></script>
    </div>
    <div class="l-page side">
      <a class="marker" href="#image-8" id="image-8">
        <img src="images/lorentz.png" style='height: 100%; width: 100%; object-fit: contain'>
      </a>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 704px" >
        Figure 8: Relation between successive maximums for the Rossler map for \(c=5\) <dt-cite key="strogatz"></dt-cite>
      </figcaption>
    </div> 
    <div class="l-page side">
      <a class="marker" href="#image-9" id="image-9">
        <img src="images/lorentzbif.png" style='height: 100%; width: 100%; object-fit: contain'>
      </a>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 704px" >
        Figure 9: Bifurcation diagram for the Rossler map <dt-cite key="strogatz"></dt-cite>
      </figcaption>
    </div> 
    <p>
      As you can see the way it behaves when changing \(c\) resembles the behavior of the logistic map. To compare these results to
      those obtained with the logistic map we are going to compare successive local maxima of \(x(t)\), Then we plot
      \(x_{max}(n+1)\) vs. \(x_{max}(n)\) where \(x_{max}(n)\) is the \(n\)-th maximum. This relation between successive maximums for
      the rossler map closely resembles the logistic map, and that is what gives us this uncanny resemblance.
      (figure <a href="#image-8">8</a>)
    </p>
    
    <p>
      By plotting all the maximums as \(c\) the bifurcation diagram shows up. Both the period doubling
      route to chaos and the 3-period window in present. 
    </p>
    <p>
      Unfortunately not all attractors have associated one-dimentional maps, to be able to have one they need to
      be very flat, so while the theory applies to mildly chaotic systems, it does not apply to fully turbolent systems
    </p>

  <h2><a class="marker" href="#section-6" id="section-6">6</a> Applications in Real Life</h2>
    <p>
      This part will be treated as a Further reading section because I didn't had the time to go in detail in 
      Real life application, what i can say is tt has been show that:
      <ul>
        <li>
          The water dripping from a faucet undergoes the period doubling route to chaos as
          the flux increases <dt-cite key="dripping"></dt-cite>
        </li>
        <li>
          Fibrillating hearts <dt-fn>A heart is fibrillating when it beats irregurally, if untreated it leads to death</dt-fn>
          become so via the the period doubling route to chaos <dt-cite key="rabbit1"></dt-cite>, and scientists used the knowledge
          from the logistic regression to control chaos in a fibrillating heart and lead it to beat normally again
          <dt-cite key="rabbit2"></dt-cite>
        </li>
        <li>
          Covection of the liquid mercury in a box with a thermal difference between the top and the bottom
          undergoes the period doubling route to chaos as the thermal difference from the top and the bottom increases
          <dt-cite key="mercury"></dt-cite>
        </li>

      </ul>

    </p>
</dt-article>

<dt-appendix>
  <h3>Acknowledgments</h3>
  <p>
    This page was written for the exam of Complex Systems held by professor Riccardo Mannella
    at the University of Pisa
  </p>
</dt-appendix>

<script type="text/bibliography">
  @online{veritasium,
    title={This equation will change how you see the world (the logistic map)},
    author={Derek Muller Veritasium},
    year={2020},
    url={https://www.youtube.com/watch?v=ovJcsL7vyrk}
  }
  @inbook{strogatz,
    author={Steven Strogatz},
    title ={NonLinear Dynamics and Chaos},
    publisher ={CRC press},
    year = {2014},
    chapter = {10},
    url={https://www.amazon.it/Nonlinear-Dynamics-Chaos-2nd-Applications/dp/0813349109/ref=sr_1_4?__mk_it_IT=%C3%85M%C3%85%C5%BD%C3%95%C3%91&crid=2PMCR6REZQLFG&dchild=1&keywords=strogatz&qid=1624542557&s=books&sprefix=strogatz%2Caps%2C294&sr=1-4}
  }
  @article{logistic,
    title={Simple mathematical models with very complicated dynamics},
    author={Robert M. May},
    journal={Nature},
    year={1976},
    url={https://www.nature.com/articles/261459a0}
  }
  @article{feigenbaum,
    title={The transition to aperiodic behavior in turbulent systems},
    author={Mitchell J. Feigenbaum},
    journal={Communications in Mathematical Physics},
    year={1980},
    url={https://link.springer.com/article/10.1007/BF01205039}
  }
  @article{rabbit1,
    title={Low dimensional chaos in cardiac tissue},
    author={Dante R. Chialvo, Robert F. Gilmour Jr, Jose Jalife },
    journal={Nature},
    year={1989},
    url={https://www.nature.com/articles/343653a0}
  }
  @article{rabbit2,
    title={Controlling Cardiac Chaos},
    author={Alan Garfinkel, Mark L. Spano, William L. Ditto, James N. Weiss},
    journal={Science},
    year={1992},
    url={https://www.nature.com/articles/343653a0}
  }
  @article{dripping,
    title={The dripping Faucet as a Model Chaotic System},
    author={Robert Shaw},
    journal={Science},
    year={1984},
    url={https://archive.org/details/ShawRobertDrippingFaucetAsAModelChaoticSystem1984_201811}
  }
  @article{mercury,
    title={Period doubling cascade in mercury, a quantitative measurement},
    author={A. Libchaber, C. Laroche, S. Fauve},
    journal={J. Physique Let},
    year={1982},
    url={https://jphyslet.journaldephysique.org/articles/jphyslet/abs/1982/07/jphyslet_1982__43_7_211_0/jphyslet_1982__43_7_211_0.html}
  }
</script>